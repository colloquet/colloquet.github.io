<html>
<head>
	<script src="http://html2canvas.hertzen.com/build/html2canvas.js"></script>
	<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
	<style type="text/css">
		#mydiv {
		    width: 200px;
		    height: 200px;
		    position: relative;

		}
		img {
			height: 200px;
			width: 200px;
			z-index: -1;
			position: absolute;
		}
		#overlay {
			position: absolute;
			left: 0;
			top: 0;
			background: rgba(0,0,0,.5);
			width: 100%;
			height: 100%;
			z-index: 0;
		}
		#mydiv p {
			position: relative;
			z-index: 2;
			color: #fff;
		}
	</style>
	<script type="text/javascript">
		function genCan() {
			var rand = Math.floor(Math.random() * (6 - 0 + 1)) + 0;
			var bg = "<img src='"+rand+".jpeg'>";
			$("#mydiv img").replaceWith(bg);
			$("#mydiv p").text($("#line").val());
			html2canvas([document.getElementById('mydiv')], {
			    onrendered: function (canvas) {
			        $('#canvas').html(canvas);
			        var data = canvas.toDataURL('image/png');
			        // AJAX call to send `data` to a PHP file that creates an image from the dataURI string and saves it to a directory on the server

			        var image = new Image();
			        image.src = data;
			        $('#image').html("<a href='"+data+"' download='image.png'>Download</a>");
			    }, useCORS: true
			});
		};
	</script>
</head>
<body>
<div id="mydiv">
    <img src="https://unsplash.it/200/200?random" />
    <p>text!</p>
    <div id="overlay"></div>
</div>
<br>
<br>
<input type="text" name="line" id="line">
<button id="genCanvas" onclick="genCan();">CANVAS</button>
<p>Canvas:</p>
<div id="canvas"></div>
    
<p>Image:</p>
<div id="image"></div>

</body>
</html>